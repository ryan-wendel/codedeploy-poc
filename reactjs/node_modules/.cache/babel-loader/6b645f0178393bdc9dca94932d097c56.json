{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/data/node/reactjs/src/App.js\";\nimport logo from \"./logo.svg\";\nimport './App.css';\n\nconst {\n  Component\n} = require('react');\n\nconst axios = require('axios'); // keep a util handy to dump objects\n\n\nconst util = require('util'); //console.log(util.inspect(error, {depth: null}))\n// grab our env variables\n\n\nconst dotenv = require('dotenv');\n/*\nconsole.log('--------------------------------------');\nconsole.log(util.inspect(process.env, {depth: null}))\nconsole.log('--------------------------------------');\n*/\n\n\nclass App extends Component {\n  constructor(props) {\n    super(props); // grab our environemtn vars\n\n    this.onDeleteClick = event => {\n      /*\n      // set up some headers\n      const options = {\n          headers: {'Content-Type': 'application/json; charset=utf-8'}\n      };\n       // nuke the file from S3 and the database using query strings\n      axios.delete(this.state.apiUrl + '/delete?fileId=' + event.target.dataset.id, options);\n      */\n      // nuke the file from S3 and the database using JSON in body\n      axios.delete(this.state.apiUrl + '/delete', {\n        headers: {\n          'Content-Type': 'application/json; charset=utf-8'\n        },\n        data: {\n          'fileId': event.target.dataset.id\n        }\n      }).then(this.setFilesTable());\n    };\n\n    this.onFileChange = event => {\n      // Update the state\n      this.setState({\n        selectedFile: event.target.files[0]\n      });\n    };\n\n    this.onTypeChange = event => {\n      // Update the state\n      this.setState({\n        fileTypeHelp: this.state.fileTypeInfo[event.target.value].help\n      });\n      this.setState({\n        fileTypeSelectValue: event.target.value\n      });\n    };\n\n    this.onDescChange = event => {\n      // Update the state\n      this.setState({\n        description: event.target.value\n      });\n    };\n\n    this.onSubmit = () => {\n      // Create an object of formData\n      const formData = new FormData(); // Update the formData object\n\n      formData.append(\"file\", this.state.selectedFile, this.state.selectedFile.name);\n      formData.append(\"fileType\", this.state.fileTypeInfo[this.state.fileTypeSelectValue].type);\n      formData.append(\"description\", this.state.description); // Request made to the backend api\n      // Send formData object\n\n      axios.post(this.state.apiUrl + '/upload', formData);\n    };\n\n    this.fileData = () => {\n      //console.log(this.state.selectedFile);\n      if (this.state.selectedFile) {\n        return /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"m-t-10px\",\n          children: [\"File Name: \", this.state.selectedFile.name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 17\n        }, this);\n      }\n    };\n\n    this.buildFileTypeSelect = () => {\n      // grab our file type info\n      const data = this.state.fileTypeInfo;\n      const fileTypeSelect = [];\n      fileTypeSelect.push( /*#__PURE__*/_jsxDEV(\"select\", {\n        className: \"Left m-l-10px\",\n        onChange: this.onTypeChange,\n        value: this.state.fileTypeSelectValue,\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 29\n      }, this));\n\n      for (let i = 0; i < data.length; i++) {\n        //console.log(i)\n        fileTypeSelect.push( /*#__PURE__*/_jsxDEV(\"option\", {\n          value: i,\n          children: data[i].text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 33\n        }, this));\n      }\n\n      fileTypeSelect.push(\"</select>\");\n      this.setState({\n        fileTypeSelect: fileTypeSelect\n      });\n    };\n\n    this.setFilesTable = () => {\n      //console.log(this.state.selectedFile);\n      // grab list of files and build a table\n      axios.get(this.state.apiUrl + '/getFiles').then(response => {\n        const data = response.data.data;\n        var tableRows = [];\n\n        for (let i = 0; i < data.length; i++) {\n          tableRows.push( /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: data[i].name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: data[i].description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"Delete-Column\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-danger btn-sm\",\n                onClick: this.onDeleteClick,\n                \"data-id\": data[i]._id,\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 174,\n                  columnNumber: 33\n                }, this), \" Delete\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 32\n          }, this));\n        }\n      });\n      const fileTable = `<table className='table table-hover table-bordered table-striped m-t-15px'>\n            <tbody>\n                ` + tableRows + `\n            </tbody>\n        </table>`;\n      this.setState({\n        fileTable: fileTable\n      });\n    };\n\n    dotenv.config(); // set \"the state\" (great old school show, btw)\n\n    this.state = {\n      apiUrl: 'http://' + process.env.REACT_APP_UPLOAD_API_HOST + ':' + process.env.REACT_APP_UPLOAD_API_PORT,\n      fileTypeSelect: [],\n      fileTypeSelectValue: 0,\n      fileTypeInfo: [],\n      selectedFile: '',\n      fileTypeHelp: '',\n      fileTable: []\n    };\n    /*\n    this.onFileChange = this.onFileChange.bind(this);\n    this.onTypeChange = this.onTypeChange.bind(this);\n    this.onDescChange = this.onDescChange.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n    */\n  }\n\n  componentDidMount() {\n    // grab our file type info and build the select options\n    axios.get(this.state.apiUrl + '/getFileTypes').then(response => {\n      const data = response.data.data;\n      this.setState({\n        fileTypeInfo: data\n      });\n      this.setState({\n        fileTypeHelp: data[this.state.fileTypeSelectValue].help\n      }); // build our file type select drop-down\n\n      this.buildFileTypeSelect();\n    }); // grab list of files and build a table\n\n    this.buildFilesTable();\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"App\",\n        children: [/*#__PURE__*/_jsxDEV(\"header\", {\n          className: \"App-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: logo,\n            className: \"App-logo\",\n            alt: \"logo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"File Upload using React!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"Main\",\n          children: [/*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"table table-hover table-bordered\",\n            children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"w-15-pct\",\n                  children: \"Description\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 204,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"text\",\n                    id: \"description\",\n                    className: \"form-control\",\n                    onChange: this.onDescChange,\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 205,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 205,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"w-15-pct\",\n                  children: \"Type\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 208,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(\"select\", {\n                    className: \"Left m-l-10px\",\n                    onChange: this.onTypeChange,\n                    value: this.state.fileTypeSelectValue,\n                    required: true,\n                    children: this.state.selectOptions\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 210,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 209,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 207,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"w-15-pct\",\n                  children: \"Image\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 216,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"file\",\n                    className: \"form-control\",\n                    onChange: this.onFileChange,\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 218,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                    className: \"form-text text-muted\",\n                    children: this.state.fileTypeHelp\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 219,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 217,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 215,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"btn btn-primary\",\n            onClick: this.onSubmit,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 29\n            }, this), \" Upload File\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 25\n          }, this), this.fileData(), this.state.fileTable]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 17\n      }, this)\n    }, void 0, false);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/data/node/reactjs/src/App.js"],"names":["Component","require","axios","util","dotenv","App","constructor","props","onDeleteClick","event","delete","state","apiUrl","headers","data","target","dataset","id","then","setFilesTable","onFileChange","setState","selectedFile","files","onTypeChange","fileTypeHelp","fileTypeInfo","value","help","fileTypeSelectValue","onDescChange","description","onSubmit","formData","FormData","append","name","type","post","fileData","buildFileTypeSelect","fileTypeSelect","push","i","length","text","get","response","tableRows","_id","fileTable","config","process","env","REACT_APP_UPLOAD_API_HOST","REACT_APP_UPLOAD_API_PORT","componentDidMount","buildFilesTable","render","logo","selectOptions"],"mappings":"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","sourcesContent":["import logo from './logo.svg';\nimport './App.css';\n\nconst { Component } = require('react');\n\nconst axios = require('axios');\n\n // keep a util handy to dump objects\n const util = require('util');\n //console.log(util.inspect(error, {depth: null}))\n\n // grab our env variables\n const dotenv = require('dotenv');\n\n /*\nconsole.log('--------------------------------------');\nconsole.log(util.inspect(process.env, {depth: null}))\nconsole.log('--------------------------------------');\n*/\n\nclass App extends Component {\n    constructor(props) {\n        super(props);\n\n        // grab our environemtn vars\n        dotenv.config();\n    \n        // set \"the state\" (great old school show, btw)\n        this.state = {\n            apiUrl: 'http://' + process.env.REACT_APP_UPLOAD_API_HOST + ':' + process.env.REACT_APP_UPLOAD_API_PORT,\n            fileTypeSelect: [],\n            fileTypeSelectValue: 0,\n            fileTypeInfo: [],\n            selectedFile: '',\n            fileTypeHelp: '',\n            fileTable: []\n        };\n\n        /*\n        this.onFileChange = this.onFileChange.bind(this);\n        this.onTypeChange = this.onTypeChange.bind(this);\n        this.onDescChange = this.onDescChange.bind(this);\n        this.onSubmit = this.onSubmit.bind(this);\n        */\n    }\n\n    componentDidMount() {  \n        // grab our file type info and build the select options\n        axios.get(this.state.apiUrl + '/getFileTypes').then(response => {\n            const data = response.data.data;\n\n            this.setState({ fileTypeInfo: data });\n            this.setState({ fileTypeHelp: data[this.state.fileTypeSelectValue].help });\n\n            // build our file type select drop-down\n            this.buildFileTypeSelect();\n        });\n\n        // grab list of files and build a table\n        this.buildFilesTable();\n    }\n\n    onDeleteClick = event => {\n        /*\n        // set up some headers\n        const options = {\n            headers: {'Content-Type': 'application/json; charset=utf-8'}\n        };\n\n        // nuke the file from S3 and the database using query strings\n        axios.delete(this.state.apiUrl + '/delete?fileId=' + event.target.dataset.id, options);\n        */\n\n        // nuke the file from S3 and the database using JSON in body\n        axios.delete(\n            this.state.apiUrl + '/delete', {\n                headers: {\n                    'Content-Type': 'application/json; charset=utf-8'\n                },\n                data: {\n                    'fileId': event.target.dataset.id\n                }\n        }).then(this.setFilesTable());\n    }\n  \n    // On file select (from the pop up)\n    onFileChange = event => {\n        // Update the state\n        this.setState({ selectedFile: event.target.files[0] });\n    };\n\n    // On file type select\n    onTypeChange = event => {\n        // Update the state\n        this.setState({ fileTypeHelp: this.state.fileTypeInfo[event.target.value].help });\n        this.setState({ fileTypeSelectValue: event.target.value });\n    };\n\n    // On description change\n    onDescChange = event => {\n        // Update the state\n        this.setState({ description: event.target.value });\n    };\n  \n    // On file upload (click the upload button)\n    onSubmit = () => {\n        // Create an object of formData\n        const formData = new FormData();\n\n        // Update the formData object\n        formData.append(\n            \"file\",\n            this.state.selectedFile,\n            this.state.selectedFile.name\n        );\n\n        formData.append(\n            \"fileType\",\n            this.state.fileTypeInfo[this.state.fileTypeSelectValue].type\n        );\n\n        formData.append(\n            \"description\",\n            this.state.description\n        );\n\n        // Request made to the backend api\n        // Send formData object\n        axios.post(this.state.apiUrl + '/upload', formData);\n    };\n  \n    fileData = () => {\n        //console.log(this.state.selectedFile);\n        if (this.state.selectedFile) {\n            return (\n                <p className='m-t-10px'>File Name: {this.state.selectedFile.name}</p>\n            );\n        } \n    };\n\n    buildFileTypeSelect = () => {\n        // grab our file type info\n        const data = this.state.fileTypeInfo;\n\n        const fileTypeSelect = [];\n\n        fileTypeSelect.push(<select className='Left m-l-10px' onChange={this.onTypeChange} value={this.state.fileTypeSelectValue} required></select>);\n\n        for(let i = 0; i < data.length; i++) {\n            //console.log(i)\n            fileTypeSelect.push(<option value={i}>{data[i].text}</option>);\n        } \n\n        fileTypeSelect.push(\"</select>\");\n\n        this.setState({ fileTypeSelect: fileTypeSelect });\n    }\n\n    setFilesTable = () => {\n        //console.log(this.state.selectedFile);\n\n        // grab list of files and build a table\n        axios.get(this.state.apiUrl + '/getFiles').then(response => {\n            const data = response.data.data;\n\n            var tableRows = [];\n\n            for(let i = 0; i < data.length; i++) {\n                tableRows.push(<tr>\n                        <td>{data[i].name}</td>\n                        <td>{data[i].description}</td>\n                        <td className='Delete-Column'>\n                            <button className='btn btn-danger btn-sm' onClick={this.onDeleteClick} data-id={data[i]._id}>\n                                <span></span> Delete\n                            </button>\n                        </td>\n                    </tr>\n                );\n            }  \n        });\n\n        const fileTable = `<table className='table table-hover table-bordered table-striped m-t-15px'>\n            <tbody>\n                ` + tableRows + `\n            </tbody>\n        </table>`;\n\n        this.setState({ fileTable: fileTable });\n\n    }\n\n    render() {\n        return (\n            <>\n                <div className='App'>\n                    <header className='App-header'>\n                        <img src={logo} className='App-logo' alt='logo' />\n                        <h3>File Upload using React!</h3>\n                    </header>\n                    <div id='Main'>\n                        <table className='table table-hover table-bordered'>\n                            <tbody>\n                                <tr>\n                                    <td className='w-15-pct'>Description</td>\n                                    <td><input type='text' id='description' className='form-control' onChange={this.onDescChange} required /></td>\n                                </tr>\n                                <tr>\n                                    <td className='w-15-pct'>Type</td>\n                                    <td>\n                                        <select className='Left m-l-10px' onChange={this.onTypeChange} value={this.state.fileTypeSelectValue} required>\n                                            {this.state.selectOptions}\n                                        </select>\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td className='w-15-pct'>Image</td>\n                                    <td>\n                                        <input type='file' className='form-control' onChange={this.onFileChange} required />\n                                        <small className='form-text text-muted'>{this.state.fileTypeHelp}</small>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <button type='button' className='btn btn-primary' onClick={this.onSubmit}>\n                            <span></span> Upload File\n                        </button>\n                        {this.fileData()}\n                        {this.state.fileTable}\n                    </div>\n                </div>\n            </>\n        );\n    }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}